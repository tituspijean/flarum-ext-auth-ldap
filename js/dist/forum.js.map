{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@tituspijean/auth-ldap/webpack/bootstrap","webpack://@tituspijean/auth-ldap/webpack/runtime/compat get default export","webpack://@tituspijean/auth-ldap/webpack/runtime/define property getters","webpack://@tituspijean/auth-ldap/webpack/runtime/hasOwnProperty shorthand","webpack://@tituspijean/auth-ldap/webpack/runtime/make namespace object","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['common/extend']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['common/app']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['components/HeaderSecondary']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['components/SettingsPage']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['components/Button']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['components/LogInModal']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['components/SignUpModal']\"","webpack://@tituspijean/auth-ldap/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@tituspijean/auth-ldap/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['extend']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['app']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['components/Modal']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['components/LogInButtons']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['utils/extractText']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['utils/ItemList']\"","webpack://@tituspijean/auth-ldap/external root \"flarum.core.compat['utils/Stream']\"","webpack://@tituspijean/auth-ldap/./src/forum/components/LDAPLogInModal.js","webpack://@tituspijean/auth-ldap/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@tituspijean/auth-ldap/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/HeaderSecondary'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/SignUpModal'];","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/LogInButtons'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['utils/Stream'];","import { extend } from 'flarum/extend';\r\nimport app from 'flarum/app';\r\n\r\nimport Modal from 'flarum/components/Modal';\r\nimport Button from 'flarum/components/Button';\r\nimport LogInButtons from 'flarum/components/LogInButtons';\r\nimport extractText from 'flarum/utils/extractText';\r\nimport ItemList from 'flarum/utils/ItemList';\r\nimport Stream from 'flarum/utils/Stream';\r\n\r\nconst translationPrefix = 'tituspijean-auth-ldap.forum.';\r\nconst translationErrorsPrefix = 'tituspijean-auth-ldap.forum.errors.';\r\n\r\nexport default class LDAPLogInModal extends Modal {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    /**\r\n     * The value of the identification input.\r\n     *\r\n     * @type {Function}\r\n     */\r\n    this.identification = Stream(this.attrs.identification || '');\r\n\r\n    /**\r\n     * The value of the password input.\r\n     *\r\n     * @type {Function}\r\n     */\r\n    this.password = Stream(this.attrs.password || '');\r\n\r\n    /**\r\n     * The value of the remember me input.\r\n     *\r\n     * @type {Function}\r\n     */\r\n    this.remember = Stream(!!this.attrs.remember);\r\n  }\r\n\r\n  className() {\r\n    return 'LogInModal Modal--small';\r\n  }\r\n\r\n  title() {\r\n    return app.translator.trans(translationPrefix + 'log_in_with', {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n  }\r\n\r\n  content() {\r\n    return [\r\n      <div className=\"Modal-body\">\r\n        {this.body()}\r\n      </div>,\r\n      <div className=\"Modal-footer\">\r\n        {this.footer()}\r\n      </div>\r\n    ];\r\n  }\r\n\r\n  body() {\r\n    return [\r\n      //<LogInButtons/>,\r\n\r\n      <div className=\"Form Form--centered\">\r\n        {this.fields().toArray()}\r\n      </div>\r\n    ];\r\n  }\r\n\r\n  fields() {\r\n    const items = new ItemList();\r\n\r\n    const idLabel = app.translator.trans('core.forum.log_in.username_or_email_placeholder');\r\n    const passwordLabel = app.translator.trans('core.forum.log_in.password_placeholder');\r\n\r\n    items.add('identification', <div className=\"Form-group\">\r\n    {idLabel}\r\n      <input className=\"FormControl\" name=\"identification\" type=\"text\" placeholder={idLabel}\r\n        bidi={this.identification}\r\n        disabled={this.attrs.loading} />\r\n    </div>, 30);\r\n\r\n    items.add('password', <div className=\"Form-group\">\r\n    {passwordLabel}\r\n      <input className=\"FormControl\" name=\"password\" type=\"password\" placeholder={passwordLabel}\r\n        bidi={this.password}\r\n        disabled={this.attrs.loading} />\r\n    </div>, 20);\r\n\r\n    /*items.add('remember', <div className=\"Form-group\">\r\n      <div>\r\n        <label className=\"checkbox\">\r\n          <input type=\"checkbox\" bidi={this.remember} disabled={this.loading} />\r\n          {app.translator.trans('core.forum.log_in.remember_me_label')}\r\n        </label>\r\n      </div>\r\n    </div>, 10);*/\r\n\r\n    items.add('submit', <div className=\"Form-group\">\r\n      {Button.component(\r\n        {\r\n          className: 'Button Button--primary Button--block',\r\n          name: 'submit_log_in',\r\n          type: 'submit',\r\n          loading: this.attrs.loading,\r\n        },\r\n        app.translator.trans('core.forum.log_in.submit_button')\r\n      )}\r\n    </div>, -10);\r\n\r\n    return items;\r\n  }\r\n\r\n  footer() {\r\n    return [\r\n      /*<p className=\"LogInModal-forgotPassword\">\r\n        <a onclick={this.forgotPassword.bind(this)}>{app.translator.trans('core.forum.log_in.forgot_password_link')}</a>\r\n      </p>,\r\n\r\n      app.forum.attribute('allowSignUp') ? (\r\n        <p className=\"LogInModal-signUp\">\r\n          {app.translator.trans('core.forum.log_in.sign_up_text', {a: <a onclick={this.signUp.bind(this)}/>})}\r\n        </p>\r\n      ) : ''*/\r\n    ];\r\n  }\r\n\r\n  onready() {\r\n    this.$('[name=' + (this.identification() ? 'password' : 'identification') + ']').select();\r\n  }\r\n\r\n  /**\r\n   * Attempt to log in a user to LDAP\r\n   */\r\n  login(body, options = {}) {\r\n    return app.request({\r\n      method: 'POST',\r\n      url: app.forum.attribute('baseUrl') + '/auth/ldap',\r\n      body,\r\n      ...options,\r\n    });\r\n  }\r\n \r\n  onsubmit(e) {\r\n    e.preventDefault();\r\n\r\n    this.loading = true;\r\n    $('input[name=\"identification\"]').prop(\"disabled\", true );\r\n    $('input[name=\"password\"]').prop(\"disabled\", true );\r\n    $('button[name=\"submit_log_in\"]').prop(\"disabled\", true );\r\n\r\n    const identification = this.identification();\r\n    const password = this.password();\r\n    const remember = this.remember();\r\n    const csrfToken = app.session.csrfToken;\r\n    const data = {\r\n      identification,\r\n      password,\r\n      remember,\r\n      csrfToken\r\n    };\r\n    const options = {\r\n      errorHandler: this.onerror.bind(this),\r\n      modifyText: this.modifyResponse.bind(this),\r\n    };\r\n    this.login(\r\n      data,\r\n      options\r\n    ).catch(() => {});\r\n  }\r\n\r\n  /*\r\n   * To ensure the request on complete will re-enable elements on the login popup or enable the sign up modal depending on the response condition.\r\n   */\r\n  modifyResponse(response) {\r\n    $('input[name=\"identification\"]').prop(\"disabled\", false );\r\n    $('input[name=\"password\"]').prop(\"disabled\", false );\r\n    $('button[name=\"submit_log_in\"]').prop(\"disabled\", false );\r\n\r\n    if (response.indexOf('app.authenticationComplete') >= 0) {\r\n      response.replace( /(^.*\\{|\\}.*$)/g, '' );\r\n      var matches = response.match(/[^{\\}]+(?=})/g);\r\n      if (matches.length > 0) {\r\n        app.authenticationComplete(JSON.parse(\"{\"+matches[0]+\"}\"));\r\n      }\r\n    } else if (response.indexOf(app.translator.trans(translationErrorsPrefix+'core_csrf_token_mismatch')) >= 0) {\r\n      // Identify the default csrf_token_mismatch response that is sent in html. Oddly this does not prompt onerror method, will manually invoke onerror method.\r\n      this.onerror({\r\n        alert: {\r\n          content: app.translator.trans(translationErrorsPrefix + 'csrf_token_mismatch'),\r\n          controls: false,\r\n          dismissible: false,\r\n          type: \"error\"\r\n        },\r\n        status: 400,\r\n        response: {\r\n          errors: [{\r\n            code: 'csrf_token_mismatch',\r\n            status: 400\r\n          }]\r\n        }\r\n      });\r\n    }\r\n    this.loaded();\r\n    return response;\r\n  }\r\n\r\n  onerror(error) {\r\n    var code_error = null;\r\n    if (error.response.errors && error.response.errors.length > 0) {\r\n      code_error = error.response.errors[0].code;\r\n    }\r\n    if (error.status === 401) {\r\n      switch(code_error) {\r\n        case 'search_filter_is_invalid':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n          break;\r\n        case 'username_field_does_not_exist':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name'),\r\n          data: error.response.errors[0].data});\r\n          break;\r\n        case 'username_is_invalid':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n          break;\r\n        case 'mail_field_does_not_exist':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name'),\r\n          data: error.response.errors[0].data});\r\n          break;\r\n        case 'not_authenticated':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n          break;\r\n        case 'account.invalid_inputs':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error);\r\n          break;\r\n        case 'account.not_found':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n          break;\r\n        case 'account.incorrect_details':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error);\r\n          break;\r\n        case 'account.password_expired':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error);\r\n          break;\r\n        case 'account.disabled':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n          break;\r\n        case 'account.expired':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n          break;\r\n        case 'account.locked':\r\n          error.alert.content = app.translator.trans(translationErrorsPrefix + code_error, {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n          break;\r\n        default:\r\n          \r\n      }\r\n    }\r\n    super.onerror(error);\r\n  }\r\n}\r\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import { extend, override } from 'flarum/common/extend';\r\nimport app from 'flarum/common/app';\r\n\r\nimport HeaderSecondary from \"flarum/components/HeaderSecondary\";\r\nimport SettingsPage from \"flarum/components/SettingsPage\";\r\nimport Button from 'flarum/components/Button';\r\n\r\nimport LogInModal from \"flarum/components/LogInModal\";\r\nimport SignUpModal from \"flarum/components/SignUpModal\";\r\nimport LDAPLogInModal from \"./components/LDAPLogInModal\";\r\nimport Stream from 'flarum/utils/Stream';\r\nimport extractText from 'flarum/utils/extractText';\r\n\r\nconst translationPrefix = 'tituspijean-auth-ldap.forum.';\r\n\r\napp.initializers.add('tituspijean-auth-ldap', () => {\r\n  extend(HeaderSecondary.prototype, 'items', addLoginLink);\r\n  extend(HeaderSecondary.prototype, 'items', removeIfOnlyUse);\r\n  extend(LogInModal.prototype, 'content', overrideLogInModal);\r\n\r\n  extend(SignUpModal.prototype, 'fields', function (items) {\r\n    if (app.forum.attribute('displayNameDriver') === 'nickname' && this.isProvided('nickname')) {\r\n      this.nickname = Stream(this.attrs.nickname || '');\r\n\r\n      items.add(\r\n        'nickname',\r\n        <div className=\"Form-group\">\r\n          <input\r\n            className=\"FormControl\"\r\n            name=\"nickname\"\r\n            type=\"text\"\r\n            placeholder={extractText(app.translator.trans('flarum-nicknames.forum.sign_up.nickname_placeholder'))}\r\n            bidi={this.nickname}\r\n            disabled={this.loading || this.isProvided('nickname')}\r\n            required={app.forum.attribute('randomizeUsernameOnRegistration')}\r\n          />\r\n        </div>,\r\n        25\r\n      );\r\n    }\r\n  });\r\n\r\n  SignUpModal.prototype.title = function() {\r\n    if (this.attrs.isLDAP) {\r\n      return app.translator.trans(translationPrefix + 'account_found', {server: app.forum.attribute('tituspijean-auth-ldap.method_name')});\r\n    } else {\r\n      return app.translator.trans('core.forum.sign_up.title');\r\n    }\r\n  }\r\n\r\n  SignUpModal.prototype.footer = function() {\r\n    if (this.attrs.isLDAP) {\r\n      return [\r\n      ];\r\n    } else {\r\n      return [\r\n        <p className=\"SignUpModal-logIn\">{app.translator.trans('core.forum.sign_up.log_in_text', { a: <a onclick={this.logIn.bind(this)} /> })}</p>,\r\n      ];\r\n    }\r\n  }\r\n\r\n  extend(SettingsPage.prototype, 'accountItems', removeProfileActions);\r\n  extend(SettingsPage.prototype, 'settingsItems', checkRemoveAccountSection);\r\n\r\n\tfunction overrideLogInModal() {\r\n\t\tif (app.forum.attribute('tituspijean-auth-ldap.onlyUse')) {\r\n\t\t\tLogInModal.prototype.content = LDAPLogInModal.prototype.content\r\n\t\t\tLogInModal.prototype.title = LDAPLogInModal.prototype.title\r\n\t\t\tLogInModal.prototype.body = LDAPLogInModal.prototype.body\r\n\t\t\tLogInModal.prototype.fields = LDAPLogInModal.prototype.fields\r\n\t\t\tLogInModal.prototype.footer = LDAPLogInModal.prototype.footer\r\n\t\t\tLogInModal.prototype.onerror = LDAPLogInModal.prototype.onerror\r\n\t\t\tLogInModal.prototype.onready = LDAPLogInModal.prototype.onready\r\n\t\t\tLogInModal.prototype.onsubmit = LDAPLogInModal.prototype.onsubmit\r\n\t\t}\r\n\t}\r\n\r\n\tfunction addLoginLink(items) {\r\n\t\tif (items.has('logIn')) {\r\n\t\t\titems.add('logInLDAP',\r\n\t\t\t\tButton.component(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclassName: 'Button Button--link',\r\n\t\t\t\t\t\tonclick: () => app.modal.show(LDAPLogInModal)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tapp.translator.trans(translationPrefix + 'log_in_with', {server: app.forum.attribute('tituspijean-auth-ldap.method_name')})\r\n\t\t\t\t),\r\n\t\t\t\t0\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction removeIfOnlyUse(items) {\r\n\t\tif (app.forum.attribute('tituspijean-auth-ldap.onlyUse')) {\r\n\t\t\tif (items.has('signUp')) {\r\n\t\t\t\titems.remove('signUp');\r\n\t\t\t}\r\n\t\t\tif (items.has('logIn')) {\r\n\t\t\t\titems.remove('logIn');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction removeProfileActions(items) {\r\n\t\titems.remove('changeEmail');\r\n\t\titems.remove('changePassword');\r\n\t}\r\n\r\n\tfunction checkRemoveAccountSection(items) {\r\n\t\tif (items.has('account') && items.get('account').children.length === 0) {\r\n\t\t\titems.remove('account');\r\n\t\t}\r\n\t}\r\n});\r\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_extends","assign","target","i","arguments","length","source","apply","this","_setPrototypeOf","p","setPrototypeOf","__proto__","translationErrorsPrefix","LDAPLogInModal","subClass","superClass","create","constructor","oninit","vnode","identification","Stream","attrs","password","remember","className","title","app","translationPrefix","server","content","body","footer","fields","toArray","items","ItemList","idLabel","passwordLabel","add","name","type","placeholder","bidi","disabled","loading","Button","onready","$","select","login","options","method","url","onsubmit","e","preventDefault","data","csrfToken","errorHandler","onerror","bind","modifyText","modifyResponse","response","indexOf","replace","matches","match","JSON","parse","alert","controls","dismissible","status","errors","code","loaded","error","code_error","Modal","extend","HeaderSecondary","has","onclick","remove","LogInModal","SignUpModal","isProvided","nickname","extractText","required","isLDAP","logIn","SettingsPage","children"],"sourceRoot":""}
(()=>{var t={n:a=>{var e=a&&a.__esModule?()=>a.default:()=>a;return t.d(e,{a:e}),e},d:(a,e)=>{for(var n in e)t.o(e,n)&&!t.o(a,n)&&Object.defineProperty(a,n,{enumerable:!0,get:e[n]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};(()=>{"use strict";t.r(a);const e=flarum.core.compat.app;var n=t.n(e);const r=flarum.core.compat["common/components/Button"];var s=t.n(r),o="tituspijean-auth-ldap.",i="tituspijean-auth-ldap.admin.settings.",l=o+"domains",d=["cn","commonname","displayname","name","givenname","initials","sn","surname","title"],c=["mail","rfc822mailbox"],u=["mailnickname","samaccountname","uid","userprincipalname"],p=["mailnickname","samaccountname","uid","userprincipalname","mail","rfc822mailbox"],h=function(t,a){void 0===t&&(t=[]),void 0===a&&(a=[]);for(var e=0;e<a.length;e++)t.indexOf(a[e])>0&&t.splice(e,0,t.splice(t.indexOf(a[e]),1)[0]);return t};n().initializers.add("tituspijean-auth-ldap",(function(t){t.extensionData.for("tituspijean-auth-ldap").registerSetting({setting:o+"method_name",label:t.translator.trans(i+"method_name"),type:"text",placeholder:"YunoHost"}).registerSetting((function(){var a,e=this;try{a=JSON.parse(this.setting(l)())}catch(t){}return Array.isArray(a)||(a=[]),m(".Form-group",[m("label",t.translator.trans(i+"domains.title")),m(".helpText",t.translator.trans(i+"domains.description")),m("table",{style:"table-layout:fixed"},[m("tbody",[a.map((function(n,r){return m("table",{border:"1px solid black"},[m("thead",m("tr",[m("th",t.translator.trans(i+"domains.banner",{index:r+1})),m("th",s().component({className:"Button Button--icon",icon:"fas fa-times",onclick:function(){a.splice(r,1),e.setting(l)(a.length>0?JSON.stringify(a):null)}}))])),m("tbody",[m("table",[m("thead",m("tr",[m("th",{width:"30%"}),m("th",{width:"70%"})])),m("tbody",[m("tr",[m("th",{colspan:2},t.translator.trans(i+"domains.header.server"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.host")),m("td",m("input.FormControl",{type:"text",value:n.host||"",placeholder:"localhost",onchange:function(t){n.host=t.target.value,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.host_help"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.port")),m("td",m("input.FormControl",{type:"number",value:n.port||389,placeholder:"389",onchange:function(t){n.port=Number(t.target.value),e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.port_help"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.version")),m("td",m("input.FormControl",{type:"number",value:n.version||3,placeholder:"3",onchange:function(t){n.version=Number(t.target.value),e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.version_help"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.base_dn")),m("td",m("input.FormControl",{type:"text",value:n.baseDN||"",placeholder:"ou=users,dc=yunohost,dc=org",onchange:function(t){n.baseDN=t.target.value,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.base_dn_help"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.filter")),m("td",m("input.FormControl",{type:"text",value:n.filter||"",placeholder:"(&(objectClass=posixAccount)(permission=cn=flarum.main,ou=permission,dc=yunohost,dc=org)",onchange:function(t){n.filter=t.target.value,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.filter_help"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.follow_referrals")),m("td",m("input",{type:"checkbox",checked:n.followReferrals,onchange:function(t){n.followReferrals=t.target.checked,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",t.translator.trans(i+"domains.data.use_ssl")),m("td",m("input",{type:"checkbox",checked:n.useSSL,onchange:function(t){n.useSSL=t.target.checked,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",t.translator.trans(i+"domains.data.use_tls")),m("td",m("input",{type:"checkbox",checked:n.useTLS,onchange:function(t){n.useTLS=t.target.checked,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("th",{colspan:2},t.translator.trans(i+"domains.header.admin"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.admin_dn")),m("td",m("input.FormControl",{type:"text",value:n.admin.dn||"",placeholder:"cn=admin,dc=yunohost,dc=org",onchange:function(t){n.admin.dn=t.target.value,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.admin_dn_help"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.admin_password")),m("td",m("input.FormControl",{type:"text",value:n.admin.password||"",placeholder:"password",onchange:function(t){n.admin.password=t.target.value,e.setting(l)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.admin_password_help"))]),m("tr",[m("th",{colspan:2},t.translator.trans(i+"domains.header.search_fields"))]),m("tr",[m("td",{colspan:2},t.translator.trans(i+"domains.header.search_fields_description"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.search_user_fields")),m("td",m("select",{oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",multiple:!0}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:$(this).val()}))})).on("select2:select",(function(t){var a=t.params.data.id,e=$(t.target).children("[value="+a+"]");e.detach(),$(t.target).append(e).change()})).val(n.searchFields||[]).trigger("change")},onedit:function(t){n.searchFields=t.detail,e.setting(l)(JSON.stringify(a))}},[h(p,n.searchFields).map((function(t){return[m("option",{value:t},t)]}))]))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.search_user_fields_help"))]),m("tr",[m("th",{colspan:2},t.translator.trans(i+"domains.header.flarum"))]),m("tr",[m("td",{colspan:2},t.translator.trans(i+"domains.header.flarum_description"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.user_username")),m("td",m("select",{value:n.user.username||"",oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",allowClear:!0,placeholder:""}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:this.value}))}))},onedit:function(t){n.user.username=t.detail,e.setting(l)(JSON.stringify(a))}},[u.map((function(t){return[m("option",{value:t},t)]}))]))]),m("tr",[m("td",t.translator.trans(i+"domains.data.user_mail")),m("td",m("select",{value:n.user.mail||"",oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",allowClear:!0,placeholder:""}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:this.value}))}))},onedit:function(t){n.user.mail=t.detail,e.setting(l)(JSON.stringify(a))}},[c.map((function(t){return[m("option",{value:t},t)]}))]))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.user_mail_help"))]),m("tr",[m("td",t.translator.trans(i+"domains.data.user_nickname_fields")),m("td",m("select",{oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",multiple:!0}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:$(this).val()}))})).on("select2:select",(function(t){var a=t.params.data.id,e=$(t.target).children("[value="+a+"]");e.detach(),$(t.target).append(e).change()})).val(n.user.nicknameFields||[]).trigger("change")},onedit:function(t){n.user.nicknameFields=t.detail,e.setting(l)(JSON.stringify(a))}},[h(d,n.user.nicknameFields).map((function(t){return[m("option",{value:t},t)]}))]))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(i+"domains.data.user_nickname_fields_help"))])])])])])})),m("tr",m("td",s().component({className:"Button Button--block",onclick:function(){a.push({host:"",port:389,version:3,baseDN:"",filter:"",admin:{dn:"",password:""},searchFields:[],user:{username:"",mail:"",nicknameFields:[]},followReferrals:!1,useSSL:!1,useTLS:!1}),e.setting(l)(JSON.stringify(a))}},t.translator.trans(i+"domains.add"))))])])])})).registerSetting({setting:o+"onlyUse",label:t.translator.trans(i+"onlyUse"),type:"boolean",default:!1}).registerSetting({setting:o+"display_detailed_error",label:t.translator.trans(i+"display_detailed_error"),type:"boolean",default:!1})}))})(),module.exports=a})();
//# sourceMappingURL=admin.js.map
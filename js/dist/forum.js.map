{"version":3,"sources":["webpack://@tituspijean/auth-ldap/webpack/bootstrap","webpack://@tituspijean/auth-ldap/./forum.js","webpack://@tituspijean/auth-ldap/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@tituspijean/auth-ldap/./src/forum/components/LDAPLogInModal.js","webpack://@tituspijean/auth-ldap/./src/forum/index.js","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['app']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['components/Button']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['components/HeaderSecondary']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['components/LogInButtons']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['components/LogInModal']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['components/Modal']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['components/SettingsPage']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['components/SignUpModal']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['extend']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['utils/ItemList']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['utils/Stream']\"","webpack://@tituspijean/auth-ldap/external \"flarum.core.compat['utils/extractText']\""],"names":["translationPrefix","LDAPLogInModal","oninit","vnode","identification","Stream","attrs","password","remember","className","title","app","translator","trans","server","forum","attribute","content","body","footer","fields","toArray","items","ItemList","add","extractText","loading","Button","component","type","onready","$","select","ldaplogin","data","options","width","height","$window","window","url","name","form","document","createElement","setAttribute","i","hasOwnProperty","input","value","appendChild","open","submit","removeChild","onsubmit","e","preventDefault","csrfToken","session","errorHandler","onerror","bind","then","location","reload","loaded","error","status","alert","props","children","Modal","initializers","extend","HeaderSecondary","prototype","addLoginLink","removeIfOnlyUse","LogInModal","overrideModal","SettingsPage","removeProfileActions","checkRemoveAccountSection","has","onclick","modal","show","remove","get","length"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","/*\n * This file is part of Flarum.\n *\n * (c) Toby Zerner <toby.zerner@gmail.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nexport * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import { extend } from 'flarum/extend';\nimport app from 'flarum/app';\n\nimport Modal from 'flarum/components/Modal';\nimport SignUpModal from 'flarum/components/SignUpModal';\nimport Button from 'flarum/components/Button';\nimport LogInButtons from 'flarum/components/LogInButtons';\nimport extractText from 'flarum/utils/extractText';\nimport ItemList from 'flarum/utils/ItemList';\nimport Stream from 'flarum/utils/Stream';\n\nconst translationPrefix = 'tituspijean-auth-ldap.forum.';\n\nexport default class LDAPLogInModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    /**\n     * The value of the identification input.\n     *\n     * @type {Function}\n     */\n    this.identification = Stream(this.attrs.identification || '');\n\n    /**\n     * The value of the password input.\n     *\n     * @type {Function}\n     */\n    this.password = Stream(this.attrs.password || '');\n\n    /**\n     * The value of the remember me input.\n     *\n     * @type {Function}\n     */\n    this.remember = Stream(!!this.attrs.remember);\n  }\n\n  className() {\n    return 'LogInModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans(translationPrefix + 'log_in_with', {server: app.forum.attribute('LDAP_method_name')});\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        {this.body()}\n      </div>,\n      <div className=\"Modal-footer\">\n        {this.footer()}\n      </div>\n    ];\n  }\n\n  body() {\n    return [\n      //<LogInButtons/>,\n\n      <div className=\"Form Form--centered\">\n        {this.fields().toArray()}\n      </div>\n    ];\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add('identification', <div className=\"Form-group\">\n      <input className=\"FormControl\" name=\"identification\" type=\"text\" placeholder={extractText(app.translator.trans('core.forum.log_in.username_or_email_placeholder'))}\n        bidi={this.identification}\n        disabled={this.loading} />\n    </div>, 30);\n\n    items.add('password', <div className=\"Form-group\">\n      <input className=\"FormControl\" name=\"password\" type=\"password\" placeholder={extractText(app.translator.trans('core.forum.log_in.password_placeholder'))}\n        bidi={this.password}\n        disabled={this.loading} />\n    </div>, 20);\n\n    /*items.add('remember', <div className=\"Form-group\">\n      <div>\n        <label className=\"checkbox\">\n          <input type=\"checkbox\" bidi={this.remember} disabled={this.loading} />\n          {app.translator.trans('core.forum.log_in.remember_me_label')}\n        </label>\n      </div>\n    </div>, 10);*/\n\n    items.add('submit', <div className=\"Form-group\">\n      {Button.component(\n        {\n          className: 'Button Button--primary Button--block',\n          type: 'submit',\n          loading: this.loading,\n        },\n        app.translator.trans('core.forum.log_in.submit_button')\n      )}\n    </div>, -10);\n\n    return items;\n  }\n\n  footer() {\n    return [\n      /*<p className=\"LogInModal-forgotPassword\">\n        <a onclick={this.forgotPassword.bind(this)}>{app.translator.trans('core.forum.log_in.forgot_password_link')}</a>\n      </p>,\n\n      app.forum.attribute('allowSignUp') ? (\n        <p className=\"LogInModal-signUp\">\n          {app.translator.trans('core.forum.log_in.sign_up_text', {a: <a onclick={this.signUp.bind(this)}/>})}\n        </p>\n      ) : ''*/\n    ];\n  }\n\n  onready() {\n    this.$('[name=' + (this.identification() ? 'password' : 'identification') + ']').select();\n  }\n\n  ldaplogin(data, options = {}) {\n      const width = 600;\n      const height = 400;\n      const $window = $(window);\n      const url = app.forum.attribute('baseUrl') + '/auth/ldap';\n      const name = \"ldapauth\";\n\n      var form = document.createElement(\"form\");\n      form.setAttribute(\"method\", \"POST\");\n      form.setAttribute(\"action\", url);\n      form.setAttribute(\"target\", name);\n      for (var i in data) {\n          if (data.hasOwnProperty(i)) {\n               var input = document.createElement('input');\n               input.type = 'hidden';\n               input.name = i;\n               input.value = data[i];\n               form.appendChild(input);\n           }\n      }\n      document.body.appendChild(form);\n\n      window.open(\"\", name,\n        `width=${width},` +\n        `height=${height},` +\n        `top=${$window.height() / 2 - height / 2},` +\n        `left=${$window.width() / 2 - width / 2},` +\n        'status=no,scrollbars=no,resizable=no');\n\n      form.submit();\n      document.body.removeChild(form);\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    const identification = this.identification();\n    const password = this.password();\n    const remember = this.remember();\n    const csrfToken = app.session.csrfToken;\n\n    this.ldaplogin({identification, password, remember, csrfToken}, {errorHandler: this.onerror.bind(this)})\n      .then(\n        () => window.location.reload(),\n        this.loaded.bind(this)\n      );\n  }\n\n  onerror(error) {\n    if (error.status === 401) {\n      error.alert.props.children = app.translator.trans('core.forum.log_in.invalid_login_message');\n    }\n\n    super.onerror(error);\n  }\n}\n","import { extend, override } from 'flarum/extend';\nimport app from 'flarum/app';\n\nimport HeaderSecondary from \"flarum/components/HeaderSecondary\";\nimport SettingsPage from \"flarum/components/SettingsPage\";\nimport Button from 'flarum/components/Button';\n\nimport LogInModal from \"flarum/components/LogInModal\";\nimport LDAPLogInModal from \"./components/LDAPLogInModal\";\n\nconst translationPrefix = 'tituspijean-auth-ldap.forum.';\n\napp.initializers.add('tituspijean-auth-ldap', function() {\n\n\textend(HeaderSecondary.prototype, 'items', addLoginLink);\n\textend(HeaderSecondary.prototype, 'items', removeIfOnlyUse);\n\textend(LogInModal.prototype, 'content', overrideModal);\n\n\textend(SettingsPage.prototype, 'accountItems', removeProfileActions);\n\textend(SettingsPage.prototype, 'settingsItems', checkRemoveAccountSection);\n\n\tfunction overrideModal() {\n\t\tif (app.forum.attribute('onlyUseLDAP')) {\n\t\t\tLogInModal.prototype.content = LDAPLogInModal.prototype.content\n\t\t\tLogInModal.prototype.title = LDAPLogInModal.prototype.title\n\t\t\tLogInModal.prototype.body = LDAPLogInModal.prototype.body\n\t\t\tLogInModal.prototype.fields = LDAPLogInModal.prototype.fields\n\t\t\tLogInModal.prototype.footer = LDAPLogInModal.prototype.footer\n\t\t\tLogInModal.prototype.onsubmit = LDAPLogInModal.prototype.onsubmit\n\t\t}\n\t}\n\n\tfunction addLoginLink(items) {\n\t\tif (items.has('logIn')) {\n\t\t\titems.add('logInLDAP',\n\t\t\t\tButton.component(\n\t\t\t\t  {\n            className: 'Button Button--link',\n            onclick: () => app.modal.show(new LDAPLogInModal())\n\t\t\t\t  },\n          app.translator.trans(translationPrefix + 'log_in_with', {server: app.forum.attribute('LDAP_method_name')})\n\t\t\t\t),\n        0\n\t\t\t);\n\t\t}\n\t}\n\n\tfunction removeIfOnlyUse(items) {\n\t\tif (app.forum.attribute('onlyUseLDAP')) {\n\t\t\tif (items.has('signUp')) {\n\t\t\t\titems.remove('signUp');\n\t\t\t}\n\t\t\tif (items.has('logIn')) {\n\t\t\t\titems.remove('logIn');\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction removeProfileActions(items) {\n\t\titems.remove('changeEmail');\n\t\titems.remove('changePassword');\n\t}\n\n\tfunction checkRemoveAccountSection(items) {\n\t\tif (items.has('account') &&\n\t\t\titems.get('account').props.children.length === 0) {\n\t\t\titems.remove('account');\n\t\t}\n\t}\n});\n","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/HeaderSecondary'];","module.exports = flarum.core.compat['components/LogInButtons'];","module.exports = flarum.core.compat['components/LogInModal'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/SettingsPage'];","module.exports = flarum.core.compat['components/SignUpModal'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['utils/Stream'];","module.exports = flarum.core.compat['utils/extractText'];"],"sourceRoot":""}